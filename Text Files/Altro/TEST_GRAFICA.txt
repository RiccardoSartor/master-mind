5 rem **** variabili e altro *****
10 min = 1
11 max = 6
12 t = 9
13 l = 4
50 poke 53281, 11 : rem sfondo
51 poke 53280, 12 : rem bordi esterni schermo

905 ?chr$(147)


14 nc=0

900 rem ***** gioco *****
910 rem ***** generazione codice casuale *****
920 x = rnd(-ti) : rem inizializzazione random
930 for i=1 to l
940 c(i)=int(rnd(1)*max)+min
950 nc = nc*10 + c(i) : rem Creazione numero generato per facilitare stampa
960 next i
970 rem ?"numero casuale: "; 
980 rem ?nc

1000 rem ***** preparazione bordi *****
1010 b1$=chr$(155)+"UCCC"+chr$(178)+"CCCCCC"+chr$(178)+"CCCCCCI"
1020 b2$=chr$(155)+chr$(171)+"CCC"+chr$(123)
1025 b2$=b2$+"CCCCCC"+chr$(123)+"CCCCCC"+chr$(179)
1030 b3$=chr$(155)+"JCCC"+chr$(177)+"CCCCCC"+chr$(177)+"CCCCCCK"
1040 r1$=chr$(155)+"B "+chr$(154)+"t "+chr$(155)+"B "+chr$(154)
1045 r1$=r1$+"cod: "+chr$(155)+"B "+chr$(154)+"ris: "+chr$(155)+"B"
1060 s0$=chr$(155)+"B   B      B      B"

1100 rem ***** stampa tabella *****
1105 ?chr$(147)
1110 ?tab(20);b1$
1120 ?tab(20);s0$
1130 ?tab(20);r1$
1140 ?tab(20);s0$
1150 for i=1 to t
1160 ?tab(20);b2$
1170 ?tab(20);s0$
1180 next i
1190 ?tab(20);b3$


1200 rem ***** inizio input *****
1205 poke 646, 14
1210 cls$="        "+chr$(157)+chr$(157)+chr$(157)+chr$(157)
1211 cls$=cls$+chr$(157)+chr$(157)+chr$(157)+chr$(157)
1215 s$=chr$(19)+chr$(17)+chr$(17)+chr$(17)+chr$(17)+chr$(17)+chr$(17)
1220 for i=1 to t : rem primo ciclo di tutti i tentativi
1225 ?chr$(145);"                 ":rem cancellaconferma
1227 poke 646, 14
1228 ?chr$(19);"numero:";nc
1230 ?chr$(19):?:?:?" tentativo n.";i
1235 ?:?" inserisci il tuo"
1240 ?" codice:";cls$;
1245 for j=1 to l
1250 get pin(j) : if pin(j)=0 then 1250
1255 ?pin(j);chr$(157);
1260 next j
1270 in=((pin(1)*10+pin(2))*10+pin(3))*10+pin(4)
1280 ?:?" confermi? (s/n):"
1290 get w$ : if w$="" then 1290
1300 if w$="n" then 1225
1310 ?chr$(145);"                 ":rem cancellaconferma

1320 ?s$;tab(21);i;chr$(155);"B";chr$(154);in;chr$(155);"B ";
1330 s$=s$+chr$(17)+chr$(17)

1400 rem ***** controlli *****
1415 v=0
1420 for j=1 to l : rem ***** azzeramento v di controllo *****
1425 n(j)=-1
1430 next j
1435 cnu=1

1450 rem ***** controllo pallini neri *****
1460 for j=1 to l 
1470 if c(j)=pin(j) goto 1500
1480 goto 1540
1490 poke 646, 0 : print "Q";
1500 poke 646, 14
1510 v=v+1
1520 n(cnu)=pin(k)
1530 cnu=cnu+1
1540 next j

1550 rem ***** controllo pallini bianchi *****
1560 rem ***** 1o ciclo for *****
1570 for j=1 to l : rem ricorda de serare mona 

1580 rem ***** 2o ciclo for *****
1590 for k=1 to l : rem ricorda de serare mona
1600 cd=0 : rem controllo doppi

1610 rem ***** 3o ciclo for controllo numeri gia usciti
1620 for z=1 to cnu
1630 if pin(k)=n(z) then cd=1
1640 next z

1650 rem ***** controllo solo tra valori *****
1660 if cd=0 then goto 1680
1670 goto 1750
1680 if c(j)=pin(k) and j<>k then goto 1700
1690 goto 1750
1700 poke 646, 1 : ?"Q";
1710 poke 646, 14
1720 n(cnu)=pin(k)
1730 cnu=cnu+1

1750 next k : rem for 1480
1760 next j

1800 rem *****controllo vittoria*****
1810 if v=4 then goto 1830 
1820 goto 1850
1830 ? "-->hai vinto"
1840 i=11

1850 rem *****controllo perdita*****
1860 ? " "
1870 if i=9 and v<>4 then ? "hai perso" 

1890 ?"Numero era:";nc

2000 next i
